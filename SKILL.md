---
name: TDX 高鐵時刻查詢
description: 查詢高鐵時刻表，自動過濾精簡結果以節省 Token
---

# TDX 高鐵時刻查詢 Skill

## 用途
當用戶詢問高鐵班次資訊時，使用此 Skill 提取關鍵參數並呼叫過濾服務。

## 步驟

### 1. 識別用戶需求
從用戶的問題中提取以下參數：
- **起站**：起始車站名稱
- **迄站**：目的車站名稱
- **日期**：出發日期（預設為今天）
- **時間限制**：只顯示某時間之後的班次（可選）

### 2. 轉換車站代碼
使用以下對照表：
| 站名 | 代碼 |
|------|------|
| 南港 | 0990 |
| 台北 | 1000 |
| 板橋 | 1010 |
| 桃園 | 1020 |
| 新竹 | 1030 |
| 苗栗 | 1035 |
| 台中 | 1040 |
| 彰化 | 1043 |
| 雲林 | 1050 |
| 嘉義 | 1055 |
| 台南 | 1060 |
| 左營 | 1070 |

### 3. 呼叫過濾服務

**內網 URL**：
```
POST http://tdx-filter-service.zeabur.internal:8080/thsr/timetable
```

**請求格式**：
```json
{
  "origin": "1040",
  "dest": "1060",
  "date": "2026-02-09",
  "after_time": "11:00",
  "limit": 10
}
```

**回應格式**：
```json
{
  "origin": "台中",
  "dest": "台南",
  "date": "2026-02-09",
  "trains": [
    {"train_no": "0817", "departure": "11:17", "arrival": "12:11", "duration_min": 54}
  ],
  "count": 5
}
```

### 4. 格式化回覆
將回應整理成易讀的表格格式回覆用戶：

```
台中 → 台南 2026-02-09 班次：

| 車次 | 出發 | 抵達 | 行駛時間 |
|------|------|------|----------|
| 0817 | 11:17 | 12:11 | 54 分鐘 |
```

## 錯誤處理

| 錯誤碼 | 說明 | 處理方式 |
|--------|------|----------|
| 400 | 參數錯誤 | 請用戶確認站名與日期 |
| 500 | 服務錯誤 | 告知用戶稍後再試 |
